<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="twitter:description" content="The TypeScript typesystem is very powerful! Powerful enough to build a fully functioning, dynamically sized, Tic Tac Toe Game with a UI displaying the state of the game."/><meta data-react-helmet="true" name="twitter:title" content="TypeScript Typelevel Tic-Tac-Toe: Overkill edition!"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:description" content="The TypeScript typesystem is very powerful! Powerful enough to build a fully functioning, dynamically sized, Tic Tac Toe Game with a UI displaying the state of the game."/><meta data-react-helmet="true" property="og:title" content="TypeScript Typelevel Tic-Tac-Toe: Overkill edition!"/><meta data-react-helmet="true" name="description" content="The TypeScript typesystem is very powerful! Powerful enough to build a fully functioning, dynamically sized, Tic Tac Toe Game with a UI displaying the state of the game."/><meta name="generator" content="Gatsby 4.16.0"/><style data-href="/styles.99eb832d1bee684823d5.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}code,kbd,samp{font-family:monospace,monospace;font-size:1em}img{border-style:none}button,input,optgroup,select,textarea{line-height:1.15}button,input{overflow:visible}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}[hidden]{display:none}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#b3d4fc;text-shadow:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

/*
! tailwindcss v3.1.8 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::-webkit-backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.fixed{position:fixed}.m-0{margin:0}.mx-2{margin-left:.5rem;margin-right:.5rem}.mb-8{margin-bottom:2rem}.mb-5{margin-bottom:1.25rem}.flex{display:flex}.h-80{height:20rem}.w-full{width:100%}.cursor-pointer{cursor:pointer}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.rounded-xl{border-radius:.75rem}.rounded-2xl{border-radius:1rem}.border{border-width:1px}.border-4{border-width:4px}.border-solid{border-style:solid}.border-yellow-400{--tw-border-opacity:1;border-color:rgb(250 204 21/var(--tw-border-opacity))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249/var(--tw-bg-opacity))}.bg-yellow-500{--tw-bg-opacity:1;background-color:rgb(234 179 8/var(--tw-bg-opacity))}.bg-neutral-900{--tw-bg-opacity:1;background-color:rgb(23 23 23/var(--tw-bg-opacity))}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.py-4{padding-bottom:1rem;padding-top:1rem}.px-10{padding-left:2.5rem;padding-right:2.5rem}.py-6{padding-bottom:1.5rem;padding-top:1.5rem}.pr-3{padding-right:.75rem}.pb-2{padding-bottom:.5rem}.pb-1{padding-bottom:.25rem}.pl-4{padding-left:1rem}.pr-10{padding-right:2.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem}.text-lg,.text-xl{line-height:1.75rem}.text-lg{font-size:1.125rem}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59/var(--tw-text-opacity))}.text-neutral-200{--tw-text-opacity:1;color:rgb(229 229 229/var(--tw-text-opacity))}.text-yellow-400{--tw-text-opacity:1;color:rgb(250 204 21/var(--tw-text-opacity))}.text-slate-300{--tw-text-opacity:1;color:rgb(203 213 225/var(--tw-text-opacity))}.text-neutral-300{--tw-text-opacity:1;color:rgb(212 212 212/var(--tw-text-opacity))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.drop-shadow-lg{--tw-drop-shadow:drop-shadow(0 10px 8px rgba(0,0,0,.04)) drop-shadow(0 4px 3px rgba(0,0,0,.1));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.card{display:grid;grid-template-areas:"overlap";grid-template-columns:1fr;grid-template-rows:1fr;transform-style:preserve-3d;transition:all 1s ease-in-out}.card-back,.card-flipped{transform:rotateY(180deg)}.card-back,.card-front{-webkit-backface-visibility:hidden;backface-visibility:hidden;grid-area:overlap}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252/var(--tw-bg-opacity))}.hover\:bg-stone-900:hover{--tw-bg-opacity:1;background-color:rgb(28 25 23/var(--tw-bg-opacity))}.hover\:text-yellow-500:hover{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.hover\:drop-shadow-xl:hover{--tw-drop-shadow:drop-shadow(0 20px 13px rgba(0,0,0,.03)) drop-shadow(0 8px 5px rgba(0,0,0,.08));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}@media (min-width:450px){.xs\:flex-row{flex-direction:row}.xs\:text-right{text-align:right}.xs\:text-xl{font-size:1.25rem;line-height:1.75rem}}@media (min-width:640px){.sm\:h-56{height:14rem}.sm\:pr-10{padding-right:2.5rem}.sm\:text-lg{font-size:1.125rem;line-height:1.75rem}}img{max-width:100%}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--blogpost-padding:15px;--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji";--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--fontSize-8:3.583rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5;--background-color:#e2e8f0}.style-font-serif{font-family:var(--fontFamily-serif)}.style-font-sans{font-family:var(--fontFamily-sans)}.font{font-family:var(--font-serif)}.bold,.style-bold{font-weight:var(--fontWeight-bold)}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{height:100%}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-12)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-4);margin-right:var(--spacing-0)}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:calc(var(--maxWidth-wrapper) + var(--blogpost-padding));padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio p,.bio-avatar{margin-bottom:var(--spacing-0)}.bio-avatar{border-radius:100%;margin-right:var(--spacing-4);min-width:50px}.blog-post{background-color:#fafafa;padding:var(--blogpost-padding)}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6YK6MBEL0X"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-6YK6MBEL0X', {"send_page_view":false});
      }
      </script><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=77cd5232de819220c659b2bb53b0cf28" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=77cd5232de819220c659b2bb53b0cf28"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=77cd5232de819220c659b2bb53b0cf28"/><title data-react-helmet="true">TypeScript Typelevel Tic-Tac-Toe: Overkill edition! | Note&#x27;s on software</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="background:rgb(226,232,240)"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">Note&#x27;s on software</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline" style="font-size:var(--fontSize-8)">TypeScript Typelevel Tic-Tac-Toe: Overkill edition!</h1><p>September 16, 2022</p></header><iframe src="https://note89.github.io//next-course-iframe/?mode=base" width="100%" frameborder="0" scrolling="no" class="h-80 sm:h-56"></iframe><section itemProp="articleBody"><p>At <a href="https://mirdin.com/">Mirdin</a> we help students to practice writing software. You might be familiar with how practicing guitar or some sport is very different from just playing/performing.</p>
<p>You will get better from just playing but it takes much longer and your understanding of what you have learned is much worse. You will learn what to do but have a harder time explaining what you have learned.</p>
<p>This is exactly how it normally is to work towards becoming a senior engineer. Senior engineers that have been through a lot gain intuition. They know that one design decision should be taken over another but they might have a hard time explaining exactly why. <b>So do you really have to spend 10 000 hours just working on projects to
achieve mastery ?</b></p>
<p>At Mirdin we believe there is a more effective way.
We try to give meaning behind every design decision to not have to use gut feeling or past experiences with similar design decisions to have an opinion on what direction to take.</p>
<p>One way we do this is by giving students a series of short design exercises that takes just a few hours to finish but will contain a lot of opportunities for things to go wrong. Then we give the students immediate feedback on how their earlier design choices affected later requirements. With smaller groups or private students, we design specific requirements for each implementation that are meant to poke holes at a student’s design.</p>
<p>The Tic-Tac-Toe challenge is not exactly in this vain but instead gives students the challenge to write a Tic-Tac-Toe program that cannot go wrong, and produce compile time errors for as many incorrect uses as possible. For example, making a move with the same player twice.</p>
<p>When I was a student at Mirdin a few years ago I decided to try to write Tic-Tac-Toe completely on the typelevel in TypeScript. This proved to be very challenging but fun. I have now expanded on that initial attempt and written this post to explain how it works in the hope to teach some more advanced typelevel TypeScript.
And maybe also make you interested in doing something similar for fun.</p>
<p>I have a lot to thank the excellent Type-Challenges for helping me learn enough type-level trickery to get this done.
<a href="https://github.com/type-challenges/type-challenges">https://github.com/type-challenges/type-challenges</a></p>
<h2>The post</h2>
<p>This is going to be a post about advanced type-level programming.  I’ll be showing you a sequence of functions, from top to bottom (mostly). I recommend treating each snippet like a puzzle. Try to understand how each of them works as you go along until you feel you could have written it yourself. We’ll start off small, with some academic-seeming type tweaks, but pretty soon you’ll find implementing type-level board logic a piece of cake.</p>
<p>I showed it to Jimmy and he was dismissive . He’s a PL Ph. D. with 10 years in Haskell, and finds type-level programming easy and uninteresting. After finishing the whole post he had a funny reaction, and shared the draft with his friends.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a8a635cc570e505fcbcd39f797b70311/46e51/jaw_dropped.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 18.9873417721519%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAABXXAAAV1wEELLsZAAAAc0lEQVQI15XNsQ7CIBRG4b7/U5jYJzAakzp2qCN2oCZICxLq0E53uCQEfnwFevaTr7k9OmOsUmp8jc45ZiainHOpqLlfL9u2z3rWH83MAFJKBaVq7p+DtV+zGCml9z6EcEBuz6d1/b2nSQhBRABijEAV/Qdez+U023D0WAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Jimmy says post is jaw dropping"
        title="Jimmy says post is jaw dropping"
        src="/static/a8a635cc570e505fcbcd39f797b70311/f058b/jaw_dropped.png"
        srcset="/static/a8a635cc570e505fcbcd39f797b70311/c26ae/jaw_dropped.png 158w,
/static/a8a635cc570e505fcbcd39f797b70311/6bdcf/jaw_dropped.png 315w,
/static/a8a635cc570e505fcbcd39f797b70311/f058b/jaw_dropped.png 630w,
/static/a8a635cc570e505fcbcd39f797b70311/40601/jaw_dropped.png 945w,
/static/a8a635cc570e505fcbcd39f797b70311/46e51/jaw_dropped.png 1003w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7cba2d05f0b2eac3fc0bce26a5055626/46e51/jimmy_comments_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 20.253164556962027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAABXXAAAV1wEELLsZAAAAsUlEQVQI13WNsQqDMBRF/f+PKKWFluLQQXQuFArtmqkSrUYT9JkYIgrmRW0HoZtnOJzlcr3X4x5EIU3TNEkIIbzkwzB0XTfP87Isq78beNHVPx12UrWc8yzLqqpqmqauaynlamPM5vh5vwVhQNNP/I4JIYwxY4zWehxHRLTWIqJzzlrr0P0bEadp8gL/fDnuG6UopUKIPM/XQwDQWksp27ZVSjHGAEAIAQC85EVR9H3/A/i22/5gpNjYAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Jimmy says he did not like the post at first, then loved it"
        title="Jimmy says he did not like the post at first, then loved it"
        src="/static/7cba2d05f0b2eac3fc0bce26a5055626/f058b/jimmy_comments_1.png"
        srcset="/static/7cba2d05f0b2eac3fc0bce26a5055626/c26ae/jimmy_comments_1.png 158w,
/static/7cba2d05f0b2eac3fc0bce26a5055626/6bdcf/jimmy_comments_1.png 315w,
/static/7cba2d05f0b2eac3fc0bce26a5055626/f058b/jimmy_comments_1.png 630w,
/static/7cba2d05f0b2eac3fc0bce26a5055626/40601/jimmy_comments_1.png 945w,
/static/7cba2d05f0b2eac3fc0bce26a5055626/46e51/jimmy_comments_1.png 1003w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>I hope you can have a similar experience but maybe get past the ‘I Hate it’
quicker!</p>
<p>It was also his idea to add the <code class="language-text">___DISPLAY___</code> that i will show you in just a sec, thanks for that Jimmy!</p>
<p>Let’s go!</p>
<h3>Where to find the code?</h3>
<p>The latest code can be found <a href="https://github.com/note89/typelevel-tic-tac-toe/blob/master/tic-tac-toe.ts">here</a> just paste it into <a href="https://www.typescriptlang.org/play">typescript-playground</a> to follow along.
</br>
TypeScript Playground as of <code class="language-text">2022-09-07</code> <a href="https://tinyurl.com/ts-tic-tac-toe">
<a href="https://tinyurl.com/ts-tic-tac-toe">https://tinyurl.com/ts-tic-tac-toe</a>
</a></p>
<h2>First: End result demo!</h2>
<p>There is gonna be a lot of code so to peak your interest let me present you with the end result.
A UI for playing Tic-Tac-Toe on the typelevel where type errors are used to display the state of the game and provide feedback for correct play.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ##################################</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #          Play a Game           #</span>
<span class="token comment">// #              of                #</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// #           Typelevel            #</span>
<span class="token comment">// #          Tic-Tac-Toe           #</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// #              UI                #</span>
<span class="token comment">// #          STARTS HERE           #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// </span>
<span class="token comment">// This is my attempt of a decent UX (hehe).</span>
<span class="token comment">// 0. Select game board size (3 => 3x3, 4 => 4x4, etc) </span>
<span class="token comment">// 1. Cross will be the first to move</span>
<span class="token comment">// 2. Just enter coordinates as a number xy</span>
<span class="token comment">//    (13 => Coordinate(x=1, y=3))</span>
<span class="token comment">// </span>
<span class="token comment">// The status checks below will turn RED </span>
<span class="token comment">// To show what state the game is in.</span>
<span class="token comment">//</span>
<span class="token comment">// Illegal moves will be compile-time errors</span>
<span class="token comment">// with decent error messages.</span>
<span class="token comment">//</span>
<span class="token comment">// Hover ___DISPLAY__ for a visual representation</span>
<span class="token comment">// of the current state of the game.</span></code></pre></div>
<h3>Display</h3>
<p><img src="/adb31bbdbd12e42b529c6e9978e59907/display.gif" alt=""></p>
<h3>Current state highlighting</h3>
<p><img src="/b3b4ec0e74b85401b242ff2f6d2332b5/states_of_game.gif" alt=""></p>
<h3>Error handling</h3>
<p><img src="/1a19974e484f98d7163eb396d1252e92/errors.gif" alt=""></p>
<h2>Requirements</h2>
<p>If you would like to give this a try yourself, here are the requirements.</p>
<p>Design an API for a Tic-Tac-Toe board, consisting of types
representing states of the board, along with functions
<code class="language-text">move</code>, <code class="language-text">takeMoveBack</code>, <code class="language-text">whoWonOrDraw</code>, and <code class="language-text">isPositionOccupied</code>.</p>
<ul>
<li>All functions must be pure</li>
<li>All functions must return a sensible value and may not throw exceptions</li>
<li>A move can only be made if
<ul>
<li>the game is not over</li>
<li>the player is the current player</li>
<li>the <code class="language-text">move</code> is valid (i.e. not already played)</li>
</ul>
</li>
<li>Calling <code class="language-text">TakeMoveBack</code> on a board with no moves is a compile-time error</li>
<li>Calling <code class="language-text">WhoWonOrDraw</code> on a tic-tac-toe board but the game has not finished is a compile-time error</li>
<li><code class="language-text">IsPositionOccupied</code> works for in-play and completed games.</li>
</ul>
<h2>Some extra design decisions</h2>
<p>I wanted the game to be possible to play on boards of any size, (3x3, 4x4, 5x5, etc).
To achieve this the winning positions need to be calculated from <code class="language-text">Size</code> instead of hard-coded.
This is possible but a bit fiddly. I have not yet achieved the ability to have two games of different <code class="language-text">Size</code> in the same project. To do that I would have to parameterize the program a bit more, this is something to try in a later version (famous last words).</p>
<h2>Show me the code!</h2>
<p>The reason this is written in TypeScript is that it’s the language I know best, and also the language I want to get better at the most but also TypeScript has a bunch of typelevel features that very few other mainstream typed languages have.</p>
<p>We will go through the code top to bottom, except for the “UI” code, which will be left for last.
There are a lot of comments in the code that are also meant to explain the program, so I will reuse them here.</p>
<style>
details{
 background: #ededed; 
 border-radius:5px; 
 padding: 10px;
 margin-bottom:10px;
}

summary {
  cursor: pointer;
  user-select: none;
}

html {
  scroll-behavior: smooth;
}
</style>
<div style="background:rgba(255,99,71,0.9);  padding: 10px; border-radius: 10px;">
  <h4 style="color: yellow; margin: 0px; padding: 15px 0px;"><b>A Note about Utils</b></h4>
  <div class="font" style="color: #fafafa; ">The code contains a quite extensive section of utility functions, 
  Instead of going though all of them first, the explanation is inlined as a optional reading at first use. So if you are more interested in how to model the problem and would like to be able to take functions like `UnionToIntersection` for granted you can. 
<p>But if you really want to know how that is implemented you can by clicking the arrow next to the section</p>
  </div>
  <details>
  <summary>Util name: Click here to expand</summary>
    Here is an explanation.
  </details>
</div>
<h2>Capturing the concepts contained in Tic-Tac-Toe</h2>
<h3>Player</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Player</span> <span class="token operator">=</span> Cross <span class="token operator">|</span> Circle<span class="token punctuation">;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Circle</span> <span class="token punctuation">{</span> __type<span class="token operator">:</span> <span class="token string">"O"</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>
  <span class="token keyword">interface</span> <span class="token class-name">Cross</span>  <span class="token punctuation">{</span> __type<span class="token operator">:</span> <span class="token string">"X"</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span></code></pre></div>
<p>We use <code class="language-text">interface</code> instead of <code class="language-text">type</code> to get the type-level information
(when you hover / or read a compile time error) to show <code class="language-text">Circle</code>
instead  <code class="language-text">{__type: "Circle"}</code> which it would do with <code class="language-text">type</code>.
It makes it a bit more pretty (not much more difference than that).</p>
<h3>Square</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Square</span> <span class="token operator">=</span> Player <span class="token operator">|</span> Empty<span class="token punctuation">;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Empty</span>  <span class="token punctuation">{</span> __type<span class="token operator">:</span> <span class="token string">"Empty"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div>
<h3>Size</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ##############################################</span>
<span class="token keyword">type</span> <span class="token class-name">Size</span> <span class="token operator">=</span> GameSize<span class="token punctuation">;</span>
<span class="token comment">// ##############################################</span></code></pre></div>
<p>The <code class="language-text">GameSize</code> is set to <code class="language-text">3</code> for this walk-through. </br>
<em>(Size was here before i made the UI at the top therefore the redeclaration)</em></p>
<h3>Column &#x26; Row</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Column and Row can potentially be different sizes</span>
<span class="token comment">// Note: winning on the diagonal will have to change </span>
<span class="token comment">// If the game is not square.</span>
<span class="token keyword">type</span> <span class="token class-name">Column</span>      <span class="token operator">=</span> ToUnion<span class="token operator">&lt;</span>FromToInc<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span>Size<span class="token operator">>></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Row</span>         <span class="token operator">=</span> ToUnion<span class="token operator">&lt;</span>FromToInc<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span>Size<span class="token operator">>></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Coordinates</span> <span class="token operator">=</span> CartesianProductString<span class="token operator">&lt;</span>Column<span class="token punctuation">,</span> Row<span class="token operator">></span></code></pre></div>
<p>The type of <code class="language-text">Column</code> and <code class="language-text">Row</code> is (in this case) <code class="language-text">1 | 2 | 3</code>.
First, we generate numbers between <code class="language-text">1</code> and <code class="language-text">Size</code> which gives us<code class="language-text">[1,2,3]</code>
then we turn that into a union and end up with <code class="language-text">1 | 2 | 3</code>.</p>
<p><code class="language-text">Coordiantes</code> have the type instance of<br>
<code class="language-text">"22" | "21" | "23" | "12" | "11" | "13" | "32" | "31" | "33"</code>.</p>
<h5>Utils used</h5>
<!-- Arithmetic START -->
<details>
<summary>Arithmetic: FromToInc, FromToDec, PlusOne, MinusOne</summary>
<h3>Arithmetic</h3>
<p>In a <code class="language-text">3x3</code> game, <code class="language-text">11,22,33</code> form a diagonal, in a <code class="language-text">4x4</code> game the diagonal is <code class="language-text">11,22,33,44</code>.
Any player that has one of these diagonals has won the game.</p>
<p>To be able to derive diagonals and other winning positions from  <code class="language-text">Size</code> we need the ability to do some
math on the typelevel. Luckily that is very possible in TypeScript.
Our needs contain only the ability to do plus and minus one. This ability will allow us to perform
typelevel recursion.</p>
<p>With many of these more exotic recursive types, there is a limit to how far they will work and
sometimes there are issues, which means you will have to try something different.
A recursive type in TypeScript 4.5 has a max call stack of <a href="https://github.com/microsoft/TypeScript/pull/45711/files#diff-d9ab6589e714c71e657f601cf30ff51dfc607fc98419bf72e04f6b0fa92cc4b8R15233"><code class="language-text">999</code></a></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// MinusOne&lt;N></span>
<span class="token comment">// Defined between 1 and 1000</span>
<span class="token comment">// Take a number N</span>
<span class="token comment">// Check if length of empty array + 1 unknown element </span>
<span class="token comment">// is equal to N, if it is, return length of array </span>
<span class="token comment">// which then is one less then N.</span>
<span class="token comment">// If not, recursively call MinusOne with an array </span>
<span class="token comment">// that is one element longer.</span>
<span class="token keyword">type</span> <span class="token class-name">MinusOne<span class="token operator">&lt;</span><span class="token constant">N</span> <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> Arr <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token operator">...</span>Arr<span class="token punctuation">,</span>
  <span class="token builtin">unknown</span>
<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'length'</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">N</span></span>
  <span class="token operator">?</span> Arr<span class="token punctuation">[</span><span class="token string">'length'</span><span class="token punctuation">]</span>
  <span class="token operator">:</span> MinusOne<span class="token operator">&lt;</span><span class="token constant">N</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>Arr<span class="token punctuation">,</span> <span class="token builtin">unknown</span><span class="token punctuation">]</span><span class="token operator">></span>

<span class="token comment">// PlusOne&lt;N></span>
<span class="token comment">// Defined between 0 and 999</span>
<span class="token comment">// Start with an array of length 0 and check if it is </span>
<span class="token comment">// equal to N. </span>
<span class="token comment">// If it is add one element to the array and return </span>
<span class="token comment">// it's length.</span>
<span class="token comment">// If not recursively call PlusOne with an array that is </span>
<span class="token comment">// one element longer.</span>
<span class="token comment">// This way we get N + 1</span>
<span class="token keyword">type</span> <span class="token class-name">PlusOne<span class="token operator">&lt;</span><span class="token constant">N</span> <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> Arr <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token punctuation">[</span><span class="token operator">...</span>Arr<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'length'</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">N</span></span>
    <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token operator">...</span>Arr<span class="token punctuation">,</span> <span class="token builtin">unknown</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'length'</span><span class="token punctuation">]</span>
    <span class="token operator">:</span> PlusOne<span class="token operator">&lt;</span><span class="token constant">N</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>Arr<span class="token punctuation">,</span> <span class="token builtin">unknown</span><span class="token punctuation">]</span><span class="token operator">></span>

<span class="token comment">// FromToInc&lt;Lower,Higher></span>
<span class="token comment">// Gives back an Array of all numbers </span>
<span class="token comment">// between Lower and Higher (inclusive)</span>
<span class="token comment">// Example: FromToInc&lt;1,3> = [1,2,3]</span>
<span class="token keyword">type</span> <span class="token class-name">FromToInc<span class="token operator">&lt;</span>From <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> 
               To <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> 
               acc <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> 
        From <span class="token keyword">extends</span> <span class="token class-name">PlusOne<span class="token operator">&lt;</span>To<span class="token operator">></span></span> 
          <span class="token operator">?</span> acc 
          <span class="token operator">:</span> FromToInc<span class="token operator">&lt;</span>PlusOne<span class="token operator">&lt;</span>From<span class="token operator">></span><span class="token punctuation">,</span> To<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>acc<span class="token punctuation">,</span> From<span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// FromToDec&lt;Higher,Lower></span>
<span class="token comment">// Gives back an Array of all numbers </span>
<span class="token comment">// between Higher and Lower (inclusive)</span>
<span class="token comment">// Example: FromToDec&lt;3,1> = [3,2,1]</span>
<span class="token keyword">type</span> <span class="token class-name">FromToDec<span class="token operator">&lt;</span>From <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> 
              To <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> 
              acc <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> 
        From <span class="token keyword">extends</span> <span class="token class-name">MinusOne<span class="token operator">&lt;</span>To<span class="token operator">></span></span> 
          <span class="token operator">?</span> acc 
          <span class="token operator">:</span> FromToDec<span class="token operator">&lt;</span>MinusOne<span class="token operator">&lt;</span>From<span class="token operator">></span><span class="token punctuation">,</span> To<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>acc<span class="token punctuation">,</span> From<span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span></code></pre></div>
</details>
<!-- Arithmetic END -->
<!-- UTIL ToUnion START -->
<details>
<summary style="cursor: pointer; user-select:none">To Union</summary>
<h3>To Union</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Example: ToUnion&lt;[1,2,3]> = 1 | 2 | 3</span>
<span class="token keyword">type</span> <span class="token class-name">ToUnion<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">>></span></span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span></code></pre></div>
<p>Array has a index signature of <code class="language-text">number</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// something like</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">...</span><span class="token punctuation">}</span></code></pre></div>
<p>So by indexing with <code class="language-text">number</code> we get back <code class="language-text">T</code>.
See <a href="https://www.typescriptlang.org/docs/handbook/2/objects.html#index-signatures">index-signatures</a> for more info.</p>
<p><code class="language-text">ToUnion</code> is purely to have a nicer API that explains better what is being done.</p>
</details>
<!-- UTIL ToUnion END -->
<!-- Cartesian Product START -->
<details>
<summary>Cartesian Product</summary>
<h3>Cartesian Product</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// CartesianProduct&lt;X,Y></span>
<span class="token comment">// Example: </span>
<span class="token comment">// CartesianProduct&lt;"a" | "b", "c" | "d"> = "ac" | "ad" | "bc" | "bd"</span>
<span class="token keyword">type</span> <span class="token class-name">CartesianProductString<span class="token operator">&lt;</span><span class="token constant">T1</span> <span class="token keyword">extends</span> ToStringableTypes<span class="token punctuation">,</span><span class="token constant">T2</span> <span class="token keyword">extends</span> ToStringableTypes <span class="token operator">></span></span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">ToStringableTypes</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> bigint<span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Cartesian</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token constant">T1</span> <span class="token keyword">extends</span> <span class="token operator">...</span> <span class="token punctuation">,</span><span class="token constant">T2</span> <span class="token keyword">extends</span> <span class="token operator">...</span><span class="token operator">></span> <span class="token operator">=</span> $<span class="token punctuation">{</span><span class="token constant">T1</span><span class="token punctuation">}</span>$<span class="token punctuation">{</span><span class="token constant">T2</span><span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">T1</code> and <code class="language-text">T2</code> can both be a union with multiple members.
Say</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token constant">T1</span> <span class="token operator">=</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span> 
<span class="token constant">T2</span> <span class="token operator">=</span> <span class="token string">"d"</span> <span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span></code></pre></div>
<p>which gives us</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">$<span class="token punctuation">{</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span> <span class="token punctuation">}</span>$<span class="token punctuation">{</span> <span class="token string">"d"</span> <span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span> <span class="token punctuation">}</span></code></pre></div>
<p>We have three choices for the first part of the string, and three choices for the second part.
So for each choice we have three other choices to choose from</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">"d"</span><span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">|</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">"d"</span> <span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">|</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c{"d" | "e" | "f"}</span><span class="token template-punctuation string">`</span></span></code></pre></div>
<p>If we multiply the three choices for the second part, we get the cartesian product of the two initial types.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token string">"ad"</span><span class="token operator">|</span> <span class="token string">"ae"</span> <span class="token operator">|</span> <span class="token string">"af"</span> <span class="token operator">|</span> <span class="token string">"bd"</span> <span class="token operator">|</span> <span class="token string">"be"</span> <span class="token operator">|</span> <span class="token string">"bf"</span> <span class="token operator">|</span> <span class="token string">"cd"</span> <span class="token operator">|</span> <span class="token string">"ce"</span> <span class="token operator">|</span> <span class="token string">"cf"</span></code></pre></div>
<p><a href="https://gist.github.com/gregberns/5e9da0c95a9a8d2b6338afe69310b945">The Algebra of algebraic data types</a>
Is a great resource if you want to learn more about this
and after reading that, you can see that
we need a member from both <code class="language-text">T1</code> and <code class="language-text">T2</code>, so we have <code class="language-text">T1 * T2 choices</code>.
So for our <code class="language-text">T1</code> and <code class="language-text">T2</code> of <code class="language-text">"a" | "b" | "c"</code> and <code class="language-text">"d" | "e" | "f"</code>  we have
<code class="language-text">3 * 3 = 9 possible pairs</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Algebraic refactoring</span>
 <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">9</span>
 <span class="token string">"ad"</span><span class="token operator">|</span> <span class="token string">"ae"</span> <span class="token operator">|</span> <span class="token string">"af"</span> <span class="token operator">|</span> <span class="token string">"bd"</span> <span class="token operator">|</span> <span class="token string">"be"</span> <span class="token operator">|</span> <span class="token string">"bf"</span> <span class="token operator">|</span> <span class="token string">"cd"</span> <span class="token operator">|</span> <span class="token string">"ce"</span> <span class="token operator">|</span> <span class="token string">"cf"</span>

 <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">9</span>
 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">"d"</span><span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | </span><span class="token template-punctuation string">`</span></span>b$<span class="token punctuation">{</span><span class="token string">"d"</span> <span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span><span class="token punctuation">}</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> | </span><span class="token template-punctuation string">`</span></span>c$<span class="token punctuation">{</span><span class="token string">"d"</span> <span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span><span class="token punctuation">}</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">

 (1 + 1 + 1) * (1 + 1 + 1) = 9
</span><span class="token template-punctuation string">`</span></span>$<span class="token punctuation">{</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span> <span class="token punctuation">}</span>$<span class="token punctuation">{</span> <span class="token string">"d"</span> <span class="token operator">|</span> <span class="token string">"e"</span> <span class="token operator">|</span> <span class="token string">"f"</span> <span class="token punctuation">}</span>` 
 <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">9</span></code></pre></div>
<p>A goal in the program is that as much as possible of the types are derived from other more basic types.
The <code class="language-text">CartesianProduct</code> function is used to produce coordinates between <code class="language-text">Rows</code> and <code class="language-text">Columns</code>,</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// simplified</span>
<span class="token keyword">type</span> <span class="token class-name">AllCoordinates</span> <span class="token operator">=</span> 
  CartesianProduct<span class="token operator">&lt;</span>Columns<span class="token punctuation">,</span>Rows<span class="token operator">></span> <span class="token operator">=</span> Col1Row1 <span class="token operator">|</span> Col2Row1 <span class="token operator">|</span> <span class="token operator">...</span> <span class="token operator">|</span> Col1Row2</code></pre></div>
</details>
<!-- Cartesian Product END -->
<h4><em>Side note</em></h4>
<p><em>Actually, the type of Column and Row is <code class="language-text">2 | 1 | 3</code>.</em>
<em>When you define a union like <code class="language-text">type A = 1 | 2 </code> the type will become <code class="language-text">A = 2 | 1</code> which on the typelevel is equivalent, however, in this application, we very much care about traversal order and numbers being in order so we need to do some extra tricks sometimes to combat this.</em>
<em>Maybe TypeScript makes no guarantees on the order of union members, so by scrambling them on purpose
it hinders people from depending on something that is not part of the spec.</em></p>
<h3>Winning positions</h3>
<p>The way we are going to see if a player has won yet
is by using the fact that we know what combination of
positions are winning, if a player has all of them they have won.
Steps:</p>
<ol>
<li>
<p>Create a union of all the winning positions</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">[</span><span class="token string">"11"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token string">"21"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">...</span> </code></pre></div>
</li>
<li>
<p>Check what the current state of all of them are</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">[</span>Circle<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> Empty<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span>Circle<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> Circle<span class="token punctuation">]</span> <span class="token operator">...</span> </code></pre></div>
</li>
<li>
<p>Create an intersection those states, and remove the array/tuple</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">[</span>Circle <span class="token operator">&amp;</span> Cross <span class="token operator">&amp;</span> Empty<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span>Circle <span class="token operator">&amp;</span> Circle <span class="token operator">&amp;</span> Circle<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">...</span> 
<span class="token punctuation">[</span><span class="token builtin">never</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span>Circle<span class="token punctuation">]</span>
<span class="token builtin">never</span> <span class="token operator">|</span> Circle
Circle</code></pre></div>
</li>
</ol>
<p>Only time we get a value is when <strong>all three are the same</strong></p>
<p>Now we can check if the player is the winner,
by checking if the intersection contains a player.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">PlayerCircle <span class="token keyword">extends</span> <span class="token class-name">Intersection</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span></code></pre></div>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// WinningPositions</span>
<span class="token comment">// All the winning positions for a Tic-Tac-Toe game.</span>
<span class="token comment">// Example</span>
<span class="token comment">// ["11", "12", "13"] | ["21", "22", "23"] | ...</span>
<span class="token keyword">type</span> <span class="token class-name">WinningPositions</span> <span class="token operator">=</span>
  <span class="token comment">// Rows</span>
  <span class="token operator">|</span> GetRowPositions<span class="token operator">&lt;</span>Column<span class="token punctuation">,</span> Row<span class="token operator">></span>
  <span class="token comment">// Columns</span>
  <span class="token operator">|</span> GetColumnPositions<span class="token operator">&lt;</span>Column<span class="token punctuation">,</span> Row<span class="token operator">></span>
  <span class="token comment">// Diagonals</span>
  <span class="token operator">|</span> GetDiagonalPositions<span class="token operator">&lt;</span>Size<span class="token operator">></span>

<span class="token comment">// ###################################</span>
<span class="token comment">// #### Winning Positions Helpers ####</span>
<span class="token comment">// ###################################</span>

<span class="token keyword">type</span> <span class="token class-name">GetRowPositions<span class="token operator">&lt;</span><span class="token constant">C</span> <span class="token keyword">extends</span> Column<span class="token punctuation">,</span> <span class="token constant">R</span> <span class="token keyword">extends</span> Row<span class="token operator">></span></span> <span class="token operator">=</span> 
    <span class="token constant">R</span> <span class="token keyword">extends</span> <span class="token class-name">Row</span> 
      <span class="token operator">?</span> <span class="token punctuation">[</span>CartesianProductString<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token operator">></span><span class="token punctuation">]</span> 
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">GetColumnPositions<span class="token operator">&lt;</span><span class="token constant">C</span> <span class="token keyword">extends</span> Column<span class="token punctuation">,</span> <span class="token constant">R</span> <span class="token keyword">extends</span> Row<span class="token operator">></span></span> <span class="token operator">=</span> 
    <span class="token constant">C</span> <span class="token keyword">extends</span> <span class="token class-name">Column</span> 
      <span class="token operator">?</span> <span class="token punctuation">[</span>CartesianProductString<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token operator">></span><span class="token punctuation">]</span> 
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">GetDiagonalPositions<span class="token operator">&lt;</span><span class="token constant">S</span> <span class="token keyword">extends</span> Size<span class="token operator">></span></span> <span class="token operator">=</span> 
    StringConcatTuples<span class="token operator">&lt;</span>Diagonals<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token operator">>></span>

<span class="token comment">// Only first type parameter is allowed to be supplied</span>
<span class="token keyword">type</span> <span class="token class-name">Diagonals<span class="token operator">&lt;</span>
      Size <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> 
      _FromToSize <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> FromToInc<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span>Size<span class="token operator">></span><span class="token punctuation">,</span> 
      _SizeToFrom <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> FromToDec<span class="token operator">&lt;</span>Size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">,</span> 
      <span class="token operator">></span></span> <span class="token operator">=</span>  
    <span class="token operator">|</span> Zip<span class="token operator">&lt;</span>_FromToSize<span class="token punctuation">,</span> _FromToSize<span class="token operator">></span> 
    <span class="token operator">|</span> Zip<span class="token operator">&lt;</span>_FromToSize<span class="token punctuation">,</span> _SizeToFrom<span class="token operator">></span>

</code></pre></div>
<p><code class="language-text">WinningPositions</code> is just the union of all positions that are winning. A position for us is just a combination(array) of coordinates. <em>(A chess position is not just a bunch of squares but also the pieces on those squares so maybe <code class="language-text">WinningPositions</code> is not the best name).</em></p>
<p><code class="language-text">GetRowPositions</code> and <code class="language-text">GetColumnPositions</code> “iterates” through either row or column and
then creates the Cartesian product between those values.
In code, it would read something like</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token function">forEach</span><span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">getCatesianProduct</span><span class="token punctuation">(</span>Column<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>So the output is <code class="language-text">["11", "21", "31"] | ["21", "22", "23"] ...</code> for <code class="language-text">Row</code> for example.
When you do <code class="language-text">R extends Row ? ... | ...</code> in TypeScript, that is “looping” over <code class="language-text">R</code> and creating a union of all the results.
The details of this are discussed in great detail in the <a href="#union-to-intersection"><code class="language-text">UnionToIntersection</code></a> util explanation.</p>
<p><code class="language-text">Diagonals</code>  have two parameters that are not allowed to be used when calling the type-level function.
This is so they can be used to bind the result of a typelevel function to allow for reuse in the function body.</p>
<p>Here we are generating two arrays <code class="language-text">[1,2,3]</code> and <code class="language-text">[3,2,1]</code> and then we do two <code class="language-text">Zip</code> operations</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">Zip<span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">></span> </code></pre></div>
<p>and</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">Zip<span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">></span></code></pre></div>
<p>which produces <code class="language-text">[[1,1],[2,2],[3,3]]</code>
and <code class="language-text">[[1,3],[2,2],[3,1]]</code></p>
<p>We then turn each tuple into strings using <code class="language-text">StringConcatTuples</code> in <code class="language-text">GetDiagonalPositions</code>. Resulting in
<code class="language-text">["11", "22", "33"]</code> and <code class="language-text">["13", "22", "31"]</code>.</p>
<h5>Utils used</h5>
<!-- ZIP START -->
<details>
<summary>Zip</summary>
<h3>Zip</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Zip two arrays together</span>
<span class="token comment">// Example: </span>
<span class="token comment">// Zip&lt;[1,2,3],["a","b","c"]> = [[1,"a"],[2,"b"],[3,"c"]]</span>
<span class="token keyword">type</span> <span class="token class-name">Zip<span class="token operator">&lt;</span>
      <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
      Acc <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token keyword">infer</span> Head<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">infer</span> Tail<span class="token punctuation">]</span> <span class="token operator">?</span> 
  <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token keyword">infer</span> Head2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">infer</span> Tail2<span class="token punctuation">]</span> <span class="token operator">?</span> 
  Zip<span class="token operator">&lt;</span>Tail<span class="token punctuation">,</span> Tail2<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>Acc<span class="token punctuation">,</span> <span class="token punctuation">[</span>Head<span class="token punctuation">,</span> Head2<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">:</span> Acc  <span class="token operator">:</span> Acc<span class="token punctuation">;</span>
</code></pre></div>
<p>Zip is a quite simple recursive function looking very much like the code version would, there is some neater ways where you would infer both heads and tails at once.
<a href="https://github.com/type-challenges/type-challenges/issues/4495">https://github.com/type-challenges/type-challenges/issues/4495</a></p>
<p>But with that implementation TypeScript fails to do type inferencinging later in the program.</p>
</details>
<!-- ZIP END -->
<!-- String Concat Tuples START -->
<details>
<summary>String Concat Tuples</summary>
<h3>String Concat Tuples</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Join tuples together to strings</span>
<span class="token comment">// Example: </span>
<span class="token comment">// StringConcatTuples&lt;[[1,2],[3,4]]> = ["12","34"]</span>
<span class="token keyword">type</span> <span class="token class-name">StringConcatTuples<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token punctuation">{</span><span class="token punctuation">[</span>Key <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">StringConcatTuples</code> is so we can use coordinates as keys, and do a lookup from coordinate to a square.</p>
<p>We use <a href="https://www.typescriptlang.org/docs/handbook/2/mapped-types.html">mapped types</a>
since it allows us to loop over the members in a type
<code class="language-text">keyof</code> gives us a type that is the union of all the <code class="language-text">keys</code> in <code class="language-text">T</code>.</p>
</details>
<!-- String Concat Tuples END -->
<h3>Board</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Fundamental data type of the game.</span>
<span class="token comment">// Board contains a mapping from Coordinate to Square</span>
<span class="token comment">// A Square is either Empty, Cross, or Circle.</span>
<span class="token keyword">type</span> <span class="token class-name">Board</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>s <span class="token keyword">in</span> Coordinates<span class="token punctuation">]</span><span class="token operator">:</span> Square <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h2>Game States</h2>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// The game can be in one of three states:</span>
<span class="token comment">// 1. Round in progress</span>
<span class="token comment">// 2. Won</span>
<span class="token comment">// 3. Draw</span>
<span class="token keyword">type</span> <span class="token class-name">GameStates</span> <span class="token operator">=</span> 
  <span class="token operator">|</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span> 
  <span class="token operator">|</span> Winner<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span>
  <span class="token operator">|</span> Draw<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span> </code></pre></div>
<h3>Round</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ###################################</span>
<span class="token comment">// ####           Round           ####</span>
<span class="token comment">// ###################################</span>
<span class="token comment">// </span>
<span class="token comment">// A Round has a bunch of Squares and a Player that is next </span>
<span class="token comment">// to move. It also has a previous Round or Nil, </span>
<span class="token comment">// to be able to allow for undoing moves.</span>
<span class="token keyword">interface</span> <span class="token class-name">Round<span class="token operator">&lt;</span>
  <span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token punctuation">,</span>
  <span class="token constant">P</span> <span class="token keyword">extends</span> Player<span class="token punctuation">,</span>
  <span class="token constant">R</span> <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">|</span> Nil
<span class="token operator">></span></span> <span class="token keyword">extends</span> <span class="token class-name">HasPrevious<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  __tag<span class="token operator">:</span> <span class="token string">"round"</span><span class="token punctuation">;</span>
  board<span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">;</span>
  nextToMove<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  <span class="token keyword">interface</span> <span class="token class-name">Nil</span>    <span class="token punctuation">{</span> __type<span class="token operator">:</span> <span class="token string">"Nil"</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>

<span class="token comment">// We separate our HasPrevious interface from the </span>
<span class="token comment">// Round interface.To be able to use it in other interfaces.</span>
<span class="token comment">// And have type level functions where the only </span>
<span class="token comment">// constraint is that it has the HasPrevious interface.</span>
<span class="token keyword">interface</span> <span class="token class-name">HasPrevious<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  previous<span class="token operator">:</span> <span class="token constant">R</span><span class="token punctuation">;</span></code></pre></div>
<h3>Winner</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Winner<span class="token operator">&lt;</span>
  <span class="token constant">S</span> <span class="token keyword">extends</span> Player<span class="token punctuation">,</span>
  PrevR <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">,</span>
  Curr <span class="token keyword">extends</span> Board
<span class="token operator">></span></span> <span class="token keyword">extends</span> <span class="token class-name">HasPrevious<span class="token operator">&lt;</span>PrevR<span class="token operator">></span></span> <span class="token punctuation">{</span>
  __tag<span class="token operator">:</span> <span class="token string">"winner"</span><span class="token punctuation">,</span>
  winningPosition<span class="token operator">:</span> Curr<span class="token punctuation">;</span>
  winner<span class="token operator">:</span> <span class="token constant">S</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3>Draw</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Draw<span class="token operator">&lt;</span><span class="token constant">R</span> <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span> 
    <span class="token keyword">extends</span> <span class="token class-name">HasPrevious<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token operator">></span></span> <span class="token punctuation">{</span>__tag<span class="token operator">:</span> <span class="token string">"draw"</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre></div>
<h4>Initial board &#x26; round</h4>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">InitialBoard</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key <span class="token keyword">in</span> <span class="token keyword">keyof</span> Board<span class="token punctuation">]</span><span class="token operator">:</span> Empty <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">InitialRound</span> <span class="token operator">=</span> Round<span class="token operator">&lt;</span>InitialBoard<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> Nil<span class="token operator">></span><span class="token punctuation">;</span></code></pre></div>
<h4>Game State Helpers</h4>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">GetBoard<span class="token operator">&lt;</span><span class="token constant">R</span> <span class="token keyword">extends</span> GameStates<span class="token operator">></span></span>
                  <span class="token operator">=</span> 
                    <span class="token constant">R</span> <span class="token keyword">extends</span> <span class="token class-name">Draw<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token keyword">infer</span> <span class="token constant">B</span><span class="token operator">></span></span>         <span class="token operator">?</span> <span class="token constant">B</span>
                  <span class="token operator">:</span> <span class="token constant">R</span> <span class="token keyword">extends</span> <span class="token class-name">Round<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span>   <span class="token operator">?</span> <span class="token constant">B</span>
                  <span class="token operator">:</span> <span class="token constant">R</span> <span class="token keyword">extends</span> <span class="token class-name">Winner<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token keyword">infer</span> <span class="token constant">B</span><span class="token operator">></span></span>  <span class="token operator">?</span> <span class="token constant">B</span>
                  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span></code></pre></div>
<h2>Game actions</h2>
<h3>Move</h3>
<p>There is only one action, it’s to make a move.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ...</span>
<span class="token comment">// Last two arguments are not allowed to be passed in, </span>
<span class="token comment">// It's used to reduce duplication in the function body.</span>
<span class="token keyword">type</span> <span class="token class-name">Move<span class="token operator">&lt;</span>
  CurrentRound <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span>Board<span class="token punctuation">,</span> <span class="token constant">P</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">,</span>
  <span class="token constant">P</span> <span class="token keyword">extends</span> Player<span class="token punctuation">,</span>
  Position <span class="token keyword">extends</span> AvailableSquares<span class="token operator">&lt;</span>CurrentRound<span class="token punctuation">[</span><span class="token string">"board"</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">,</span>
  _NextBoard <span class="token keyword">extends</span> Board <span class="token operator">=</span> 
    SetSquare<span class="token operator">&lt;</span>CurrentRound<span class="token punctuation">[</span><span class="token string">"board"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Position<span class="token punctuation">,</span> <span class="token constant">P</span><span class="token operator">></span><span class="token punctuation">,</span>
  _NextRound <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
    Round<span class="token operator">&lt;</span>_NextBoard<span class="token punctuation">,</span> GetNextPlayer<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">></span><span class="token punctuation">,</span> CurrentRound<span class="token operator">></span>
<span class="token operator">></span></span> <span class="token operator">=</span> 
HasWon<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">,</span>_NextRound<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token boolean">true</span></span> <span class="token operator">?</span>
  <span class="token operator">?</span> Winner<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">,</span> CurrentRound<span class="token punctuation">,</span> _NextBoard<span class="token operator">></span>
  <span class="token operator">:</span> NoMoreSquares<span class="token operator">&lt;</span>_NextBoard<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token boolean">true</span></span>
    <span class="token operator">?</span> Draw<span class="token operator">&lt;</span>CurrentRound<span class="token punctuation">,</span> _NextBoard<span class="token operator">></span>
    <span class="token operator">:</span> _NextRound</code></pre></div>
<p>Move steps:</p>
<ol>
<li>Check if the position is part of <code class="language-text">AvailableSquares[CurrentRound['board']]</code></li>
<li>Create two variables, which are the board and round after the move has been applied
<code class="language-text">_NextBoard</code> and <code class="language-text">_NextRound</code></li>
<li>Check if player has won in the <code class="language-text">_NextRound</code>, if <code class="language-text">true</code> return <code class="language-text">Winner&lt;P, ...></code></li>
<li>Check if the game will have no more squares after this move, if true return <code class="language-text">Draw&lt;...></code></li>
<li>Else return next Round.</li>
</ol>
<h2>Game state functions</h2>
<h3>Available Squares</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Squares that are possible to play on</span>
<span class="token keyword">type</span> <span class="token class-name">AvailableSquares<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Coordinate <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">B</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">[</span>Coordinate<span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">Empty</span> <span class="token operator">?</span>
        Coordinate 
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">B</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">AvailableSquares</code> loops through the coordinates and replaces every square with either the <code class="language-text">Coordinate</code> or <code class="language-text">never</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span>
 <span class="token string-property property">"11"</span><span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">,</span> 
 <span class="token string-property property">"12"</span><span class="token operator">:</span> <span class="token string">"12"</span><span class="token punctuation">,</span>
 <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We then lookup all values for all keys with <code class="language-text">[keyof B]</code> this produces a union like
<code class="language-text">never | "12" | ... </code> and since <code class="language-text">never</code> represents the absence of a value.
<code class="language-text">never</code> gets removed from unions leaving only the squares that are possible to play.</p>
<h3>Get next player</h3>
<p>Toggles between the players</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">GetNextPlayer<span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token keyword">extends</span> Player<span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name">Cross</span> <span class="token operator">?</span> Circle <span class="token operator">:</span> Cross<span class="token punctuation">;</span>
</code></pre></div>
<h3>Set square</h3>
<p>Find and replace what is on a square, by looping through all coordinates
until we find the one we want to set.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Sets a Square to a Player</span>
<span class="token keyword">type</span> <span class="token class-name">SetSquare<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token punctuation">,</span> CoordinateToSet<span class="token punctuation">,</span> Player<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Coord <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">B</span><span class="token punctuation">]</span><span class="token operator">:</span> Coord <span class="token keyword">extends</span> <span class="token class-name">CoordinateToSet</span> <span class="token operator">?</span>
      Player 
    <span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">[</span>Coord<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h3>No more squares</h3>
<p>If the <code class="language-text">Board</code> extends <code class="language-text">never</code> that means there was nothing in the union
returned by <code class="language-text">AvailableSquares&lt;B></code>, thus there are no more squares to play on.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">NoMoreSquares<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token operator">></span></span> <span class="token operator">=</span> 
  AvailableSquares<span class="token operator">&lt;</span><span class="token constant">B</span><span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">never</span></span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span></code></pre></div>
<h3>Get winner</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// If there is a winner in the Squares provided then </span>
<span class="token comment">// the winner is returned.</span>
<span class="token keyword">type</span> <span class="token class-name">GetWinner<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token operator">></span></span> <span class="token operator">=</span>
   UniqueInSequence<span class="token operator">&lt;</span>LookupCoordinates<span class="token operator">&lt;</span>WinningPositions<span class="token punctuation">,</span><span class="token constant">B</span><span class="token operator">>></span>

<span class="token comment">// LookupPosition returns the state of the squares </span>
<span class="token comment">// at each position listed</span>
<span class="token comment">// ["11", "12", "13"] | ... -> [Circle, Circle, Circle] | ..</span>
<span class="token keyword">type</span> <span class="token class-name">LookupCoordinates<span class="token operator">&lt;</span>
        Coords <span class="token keyword">extends</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>Coordinates<span class="token operator">></span><span class="token punctuation">,</span> 
        <span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token operator">></span></span> <span class="token operator">=</span>
    <span class="token punctuation">{</span> <span class="token punctuation">[</span>Key <span class="token keyword">in</span> <span class="token keyword">keyof</span> Coords <span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">[</span>Coords<span class="token punctuation">[</span>Key<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>

<span class="token comment">// If there is any Array that contains only the same element</span>
<span class="token comment">// then that element will be returned</span>
<span class="token keyword">type</span> <span class="token class-name">UniqueInSequence<span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token operator">>></span></span> <span class="token operator">=</span>
  <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token operator">></span></span> <span class="token operator">?</span> 
    UnionToIntersection<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token builtin">never</span>
</code></pre></div>
<p>We use the <code class="language-text">WinningPositions</code> together with a <code class="language-text">Board</code> to look up the state of all those winning tuples.
We then see if any of those tuples of coordinates only contain one player.</p>
<p><code class="language-text">GetWinner</code> might not be the perfect name, because it gives back whatever is unique in a winning set of squares so for example it would return <code class="language-text">Empty</code> for the initial board.
<em>(So the game starts out with <code class="language-text">Empty</code> as a winner one could say)</em></p>
<h4>Utils used</h4>
<!-- Union To Intersection START -->
<details id="union-to-intersection">
<summary>Union To Intersection (very long!)</summary>
<h3>Union To Intersection</h3>
<p>This is going to be the longest explanation in the whole post (it even has a quiz!)
so bear with me. I think this can be very instructive if you don’t already know all this
at a deep level. This was very useful for me to write if nothing else.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// UnionToIntersection&lt;X></span>
<span class="token comment">// Takes a union like `A | B | C` and </span>
<span class="token comment">// returns an intersection like `A &amp; B &amp; C`</span>
<span class="token keyword">type</span> <span class="token class-name">UnionToIntersection<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  _PutUnionMembersIntoFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token keyword">extends</span> 
      <span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">I</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span><span class="token punctuation">)</span> 
          <span class="token operator">?</span>  <span class="token constant">I</span> 
          <span class="token operator">:</span> <span class="token builtin">never</span>

<span class="token keyword">type</span> <span class="token class-name">_PutUnionMembersIntoFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> 
      <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> 
        <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span>  
        <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span></code></pre></div>
<p>The creator of <code class="language-text">UnionToIntersection</code> is as far as i know <a href="https://github.com/microsoft/TypeScript/issues/29594#issuecomment-507673155">Jcalz</a></p>
<p>It’s not much code is it, but there is a lot to unpack! and it’s worthy of a through
explanation.
The function has been somewhat of a debated topic, if it’s a hack or not?, and if it should be included in official <code class="language-text">lib.d.ts</code> or not.
I’m most certainly don’t think this is a hack at all, if this would break in a future version of
TypeScript, i think that would break a lot of other things too.</p>
<p>Sources where i learned about this function</p>
<ul>
<li><a href="https://stackoverflow.com/questions/50374908/transform-union-type-to-intersection-type/50375286#50375286">https://stackoverflow.com/questions/50374908/transform-union-type-to-intersection-type/50375286#50375286</a></li>
<li><a href="https://github.com/microsoft/TypeScript/issues/29594#issuecomment-507673155">https://github.com/microsoft/TypeScript/issues/29594#issuecomment-507673155</a></li>
</ul>
<p>There are two parts to the <code class="language-text">UnionToIntersection</code> function and i will go through them separately now.</p>
<h3>PART 1</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">_PutUnionMembersIntoFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> 
      <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> 
        <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span>  
        <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span></code></pre></div>
<p>This is using <code class="language-text">U</code> as a ‘naked’ type parameter.
Seems this lingo is no longer part of the <a href="https://www.typescriptlang.org/docs/handbook/2/conditional-types.html#distributive-conditional-types">official docs</a>, which is a shame,
will make it harder to understand, why things act like they do.</p>
<p><a href="https://stackoverflow.com/questions/51651499/typescript-what-is-a-naked-type-parameter">Naked type parameters distributes over a union</a>.
This means the conditional part will be applied to each member of the union.
and the result will be a union of all applications of the conditional.
)</p>
<p>Let me show you.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">_PutUnionMembersIntoFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> 
      <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> 
        <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span>  
        <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">ABC</span></span> <span class="token operator">=</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span>
<span class="token keyword">type</span> <span class="token class-name">_</span> <span class="token operator">=</span> _PutUnionMembersIntoFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">ABC</span><span class="token operator">></span></code></pre></div>
<h4>Replacement steps naked type param</h4>
<p>To Replace <code class="language-text">U</code> with supplied type <code class="language-text">ABC</code> in the body
of <code class="language-text">_PutUnionMembersIntoFunctionArgumentPosition</code>
check if <code class="language-text">U</code> is ‘clothed’ or ‘naked’.
<code class="language-text">U</code> is naked do a replacement for each member in
<code class="language-text">ABC</code> and make a union of the results.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">  <span class="token string">"a"</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">:</span> <span class="token builtin">never</span> 
<span class="token operator">|</span> <span class="token string">"b"</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"b"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">:</span> <span class="token builtin">never</span> 
<span class="token operator">|</span> <span class="token string">"c"</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"c"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">:</span> <span class="token builtin">never</span></code></pre></div>
<p>Which simplifies to</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">  <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span>  
<span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"b"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span>  
<span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"c"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span></code></pre></div>
<h4>Common error</h4>
<p>Many people (including myself in the past) think that a type parameter
get’s inlined into the type level function like.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token generic-function"><span class="token function">_PutUnionMembersIntoFunctionArgumentPosition</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token string">"a"</span><span class="token operator">|</span><span class="token string">"b"</span><span class="token operator">|</span><span class="token string">"c"</span><span class="token operator">></span></span></span>
<span class="token punctuation">(</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> 
  <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">:</span> <span class="token builtin">never</span></code></pre></div>
<h1><strong>-------- THIS IS WRONG! --------</strong></h1>
<p>To get that behavior, the type parameter need to be ‘clothed’.</p>
<h4>Clothed example</h4>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">_PutInFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token operator">=</span> 
    <span class="token punctuation">[</span><span class="token constant">U</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">any</span><span class="token punctuation">]</span> 
        <span class="token operator">?</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span> 
        <span class="token operator">:</span> <span class="token builtin">never</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">ABC</span></span> <span class="token operator">=</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span>
<span class="token keyword">type</span> <span class="token class-name">_</span>   <span class="token operator">=</span> _PutInFunctionArgumentPosition<span class="token operator">&lt;</span><span class="token constant">ABC</span><span class="token operator">></span></code></pre></div>
<h4>Replacement steps clothed type param</h4>
<p>To Replace <code class="language-text">U</code> with supplied type <code class="language-text">ABC</code> in the body of
<code class="language-text">_PutInFunctionArgumentPosition</code> check if <code class="language-text">U</code> is ‘clothed’ or ‘naked’.
<code class="language-text">U</code> is ‘clothed’ so do the replacement <strong>inline</strong>.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">any</span><span class="token punctuation">]</span> <span class="token operator">?</span> 
    <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">)</span></code></pre></div>
<p>Which simplifies to</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(k: "a" | "b" | "c") => void</code></pre></div>
<h3>QUIZ</h3>
<p>To test yourself on the difference between ‘naked’ and ‘clothed’,
Think of the results of <code class="language-text">Inline</code> and calling the functions
with <code class="language-text">ABC</code> and <code class="language-text">ABC3</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">ABC</span></span>  <span class="token operator">=</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">ABC3</span></span> <span class="token operator">=</span> <span class="token constant">ABC</span> <span class="token operator">|</span> <span class="token number">3</span>

<span class="token keyword">type</span> <span class="token class-name">ABC_Inline_Extends_A</span>      <span class="token operator">=</span> <span class="token constant">ABC</span> <span class="token keyword">extends</span>   <span class="token string">"a"</span>    <span class="token operator">?</span> 
                                     <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token constant">ABC</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
                                    <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token keyword">type</span> <span class="token class-name">Naked_Extends_A<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span>        <span class="token operator">=</span>  <span class="token constant">T</span>  <span class="token keyword">extends</span>   <span class="token string">"a"</span>    <span class="token operator">?</span> 
                                     <span class="token punctuation">(</span>k<span class="token operator">:</span>  <span class="token constant">T</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
                                    <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token keyword">type</span> <span class="token class-name">Naked_Extends_String<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span>   <span class="token operator">=</span>  <span class="token constant">T</span>  <span class="token keyword">extends</span>  <span class="token class-name"><span class="token builtin">string</span></span>  <span class="token operator">?</span> 
                                     <span class="token punctuation">(</span>k<span class="token operator">:</span>  <span class="token constant">T</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
                                    <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token keyword">type</span> <span class="token class-name">Clothed_Extends_String<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span> <span class="token operator">?</span> 
                                     <span class="token punctuation">(</span>k<span class="token operator">:</span>  <span class="token constant">T</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
                                    <span class="token operator">:</span> <span class="token builtin">never</span></code></pre></div>
<h4>QUIZ Answers</h4>
<p><a href="https://tinyurl.com/typescript-quiz">https://tinyurl.com/typescript-quiz</a></p>
<p><em>Note:</em>
<em>If we would change the type of <code class="language-text">_PutUnionMembersIntoFunctionArgumentPosition</code> to be
<code class="language-text">(k: U) => void</code>, we would also get <code class="language-text">(k: "a" | "b" | "c") => void</code>.
We need the <code class="language-text">U extends any ?</code> to distribute the union.</em></p>
<p>Moving on…</p>
<h3>PART 2</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token operator">...</span><span class="token constant">PART1</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">I</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">I</span> <span class="token operator">:</span> <span class="token builtin">never</span></code></pre></div>
<p>So Part 1 gave use the result</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">  <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span>  
<span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"b"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span>  
<span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"c"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span></code></pre></div>
<p>We are not replacing any type-parameter in PART2, so we can just
inline the results from calling <code class="language-text">_PutUnionMembersIntoFunctionArgumentPosition&lt;U></code>.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">(</span>    <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> 
   <span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"b"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> 
   <span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"c"</span><span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">I</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">I</span> <span class="token operator">:</span> <span class="token builtin">never</span></code></pre></div>
<p>(If you have not heard about <code class="language-text">infer</code> before look at these docs.
<a href="https://learntypescript.dev/09/l2-conditional-infer">https://learntypescript.dev/09/l2-conditional-infer</a>)</p>
<p>We are saying here that there is a function</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">I</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> </code></pre></div>
<p>that can be either</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">     <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
  <span class="token function">or</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"b"</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
  <span class="token function">or</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token string">"c"</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span></code></pre></div>
<p><strong>It’s not the argument to the function that can be <code class="language-text">"a" | "b" | "c"</code>.
There are three separate functions with those argument, and we DON’T know which one we will have.</strong>
Therefore ghe only <strong>SAFE</strong> argument to</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">I</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> </code></pre></div>
<p>the intersection of all possible arguments.</p>
<p>That might had been a bit confusing, so let’s look at one example</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> HasName<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> HasAge<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span>
<span class="token keyword">const</span> func <span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token operator">...</span></code></pre></div>
<p>If we now want to call <code class="language-text">func</code> what argument do we need to give it ?</p>
<p>Well we don’t know if <code class="language-text">T</code> is</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">   <span class="token punctuation">(</span>k<span class="token operator">:</span> HasName<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> 
<span class="token function">or</span> <span class="token punctuation">(</span>k<span class="token operator">:</span> HasAge<span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token keyword">void</span></code></pre></div>
<p>So we need to call <code class="language-text">func</code> with an argument <strong>that is both</strong>.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> HasName <span class="token operator">&amp;</span> HasAge
<span class="token keyword">const</span> dog <span class="token operator">:</span> Dog <span class="token operator">=</span> <span class="token function">createDog</span><span class="token punctuation">(</span><span class="token string">"Fido"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">func</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span></code></pre></div>
<p><em>Thank AnyHowStep for this <a href="https://github.com/microsoft/TypeScript/issues/29594#issuecomment-507701193">answer</a> that helped me write this section</em></p>
</details>
<!-- Union To Intersection END -->
<h3>Has Won</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">HasWon<span class="token operator">&lt;</span>
  <span class="token constant">P</span> <span class="token keyword">extends</span> Player<span class="token punctuation">,</span>
  <span class="token constant">B</span> <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span>
<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name">GetWinner<span class="token operator">&lt;</span><span class="token constant">B</span><span class="token punctuation">[</span><span class="token string">"squares"</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span></code></pre></div>
<h2>Extra functions from requirements</h2>
<h3>Who won or draw ?</h3>
<p>Just a function that gives back a string informing
who won or if it’s a draw, only possible to call when the game state is
either <code class="language-text">Draw</code> or <code class="language-text">Winner</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">WhoWonOrDraw<span class="token operator">&lt;</span>
    <span class="token constant">A</span> <span class="token keyword">extends</span> Draw<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token operator">></span> 
  <span class="token operator">|</span> Winner<span class="token operator">&lt;</span>Player<span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  state<span class="token operator">:</span> <span class="token constant">A</span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">A</span> <span class="token keyword">extends</span> <span class="token class-name">Winner<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span>
  <span class="token operator">?</span> PlayerWinnerString<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">></span>
  <span class="token operator">:</span> DrawString<span class="token punctuation">;</span>
  <span class="token keyword">type</span> <span class="token class-name">DrawString</span> <span class="token operator">=</span> <span class="token string">"The game was a draw"</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">PlayerWinnerString<span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token keyword">extends</span> Player<span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name">Circle</span> <span class="token operator">?</span> 
    CircleWonString
  <span class="token operator">:</span> CrossWonString
  <span class="token keyword">type</span> <span class="token class-name">CircleWonString</span> <span class="token operator">=</span> <span class="token string">"Circle Won the game"</span>
  <span class="token keyword">type</span> <span class="token class-name">CrossWonString</span> <span class="token operator">=</span> <span class="token string">"Cross Won the game"</span>
</code></pre></div>
<h3>Take move back</h3>
<p>Any round except the initial round has a previous round.
This function gives back that previous round.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">TakeMoveBack<span class="token operator">&lt;</span>
        <span class="token constant">R</span> <span class="token keyword">extends</span> HasPrevious<span class="token operator">&lt;</span>Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span>
        <span class="token operator">></span></span> <span class="token operator">=</span> 
        <span class="token constant">R</span><span class="token punctuation">[</span><span class="token string">"previous"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>
<h3>Is position occupied?</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">IsPositionOccupied<span class="token operator">&lt;</span>
  <span class="token constant">RW</span> <span class="token keyword">extends</span> Winner<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">|</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">,</span>
  Coord <span class="token keyword">extends</span> Coordinates<span class="token punctuation">,</span>
  <span class="token constant">B</span> <span class="token keyword">extends</span> Board <span class="token operator">=</span> GetBoard<span class="token operator">&lt;</span><span class="token constant">RW</span><span class="token operator">></span>
<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token constant">B</span><span class="token punctuation">[</span>Coord<span class="token punctuation">]</span> 
<span class="token punctuation">)</span> <span class="token keyword">extends</span> <span class="token class-name">Empty</span>
  <span class="token operator">?</span> <span class="token boolean">false</span>
  <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>That is all the code related to the fundamentals of the game!</strong></p>
<p>There is some extra code for the ‘Game UI’ to play the game in a nicer
way than you will see in the tests.
We will go through that code last.</p>
<h1>Tests</h1>
<p>Note, since these are <code class="language-text">typelevel</code> tests we want to be able
to test that we do get <code class="language-text">type-errors</code>, when we should while
allowing the program to compile. TypeScript gives us this handy comment we can use to check for type errors.</p>
<blockquote>
<p><code class="language-text">@ts-expect-error</code></p>
</blockquote>
<p><a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-9.html#-ts-expect-error-comments" target="__blank"><code class="language-text">@ts-expect-error</code></a> gives an error if there is <strong>no</strong> error.</p>
<h3>Test Utils</h3>
<p>We need some type-level utility functions to help us with
the game. <code class="language-text">Equal</code> and <code class="language-text">Expect</code> functions have been taken from
the excellent
<a href="https://github.com/type-challenges/type-challenges/blob/master/utils/index.d.ts" target="__blank">
type-challenges
</a>
repo.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">Equal<span class="token operator">&lt;</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">Y</span><span class="token operator">></span> 
Check <span class="token keyword">if</span> two types are equal<span class="token punctuation">.</span></code></pre></div>
<p>For full discussion around this <a href="https://github.com/Microsoft/TypeScript/issues/27024#issuecomment-421529650" target="__blank">TypeScript issue</a></p>
<blockquote>
<p>…It relies on conditional types being deferred when T is not known.
Assignability of deferred conditional types relies on an internal isTypeIdenticalTo check,
which is only true for two conditional types if:</p>
<ul>
<li>Both conditional types have the same constraint</li>
<li>The true and false branches of both conditions are the same type</li>
</ul>
<a href="https://github.com/Microsoft/TypeScript/issues/27024#issuecomment-510924206">
- fatcerberus</a>
</blockquote>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Equal<span class="token operator">&lt;</span><span class="token constant">X</span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">X</span></span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> 
  <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">Y</span></span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// Expect&lt;T></span>
<span class="token comment">// Give type-level error if T is not true</span>
<span class="token keyword">type</span> <span class="token class-name">Expect<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token boolean">true</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">;</span>
</code></pre></div>
<details>
<summary>Show Test Cases</summary>
<h3>Test cases</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #         Correct strings        #</span>
<span class="token comment">// ##################################</span>
<span class="token keyword">type</span> <span class="token class-name">CircleWonStringTest</span> <span class="token operator">=</span> 
  Expect<span class="token operator">&lt;</span>
      Equal<span class="token operator">&lt;</span>
          ReturnType<span class="token operator">&lt;</span>WhoWonOrDraw<span class="token operator">&lt;</span>WinCircleFinal<span class="token operator">>></span><span class="token punctuation">,</span> 
          CircleWonString
          <span class="token operator">></span>
        <span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">CrossWonStringTest</span> <span class="token operator">=</span> 
  Expect<span class="token operator">&lt;</span>
      Equal<span class="token operator">&lt;</span>
          ReturnType<span class="token operator">&lt;</span>WhoWonOrDraw<span class="token operator">&lt;</span>WinCrossFinal<span class="token operator">>></span><span class="token punctuation">,</span> 
          CrossWonString
          <span class="token operator">></span>
        <span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">DrawStringTest</span> <span class="token operator">=</span> 
  Expect<span class="token operator">&lt;</span>
      Equal<span class="token operator">&lt;</span>
          ReturnType<span class="token operator">&lt;</span>WhoWonOrDraw<span class="token operator">&lt;</span>DrawFinal<span class="token operator">>></span><span class="token punctuation">,</span> 
          DrawString
          <span class="token operator">></span>
        <span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #         No double moves        #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// @ts-expect-error</span>
<span class="token keyword">type</span> <span class="token class-name">NoDoubleMove</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>
                      Move<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">,</span> 
                                         Cross<span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #      No start with Circle      #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// @ts-expect-error</span>
<span class="token keyword">type</span> <span class="token class-name">NoStartWithCircle</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">;</span>


<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #      No taking a used square   #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// @ts-expect-error</span>
<span class="token keyword">type</span> <span class="token class-name">NoTakingAUsedSquare</span> <span class="token operator">=</span> 
  Move<span class="token operator">&lt;</span>
    Move<span class="token operator">&lt;</span>
      InitialRound<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span>  <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">,</span> 
                    Circle<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span>

<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #  InitialRound has no previous  #</span>
<span class="token comment">// #  Don't allow to take too many  #</span>
<span class="token comment">// #           moves back           #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// @ts-expect-error</span>
<span class="token keyword">type</span> <span class="token class-name">NotToManyMovesBack</span> <span class="token operator">=</span> TakeMoveBack<span class="token operator">&lt;</span>InitialRound<span class="token operator">></span><span class="token punctuation">;</span>


<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #         Making a move          #</span>
<span class="token comment">// #       and taking it back       #</span>
<span class="token comment">// #   Gives back the start state   #</span>
<span class="token comment">// ##################################</span>
<span class="token keyword">type</span> <span class="token class-name">MoveOne</span>      <span class="token operator">=</span> Move<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">BackToNormal</span> <span class="token operator">=</span> TakeMoveBack<span class="token operator">&lt;</span>MoveOne<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Outcome</span>      <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  Equal<span class="token operator">&lt;</span>
    InitialRound<span class="token punctuation">,</span> 
    BackToNormal
  <span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">BackFromDraw</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
                      Equal<span class="token operator">&lt;</span>
                        TakeMoveBack<span class="token operator">&lt;</span>DrawFinal<span class="token operator">></span><span class="token punctuation">,</span> 
                        DrawStep8
                           <span class="token operator">></span>
                          <span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">BackFromWin</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
                      Equal<span class="token operator">&lt;</span>
                        TakeMoveBack<span class="token operator">&lt;</span>WinCrossFinal<span class="token operator">></span><span class="token punctuation">,</span> 
                        WinCrossStep4
                            <span class="token operator">></span>
                          <span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #       IsPositionOccupied       #</span>
<span class="token comment">// ##################################</span>
<span class="token keyword">type</span> <span class="token class-name">Test</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  Equal<span class="token operator">&lt;</span>IsPositionOccupied<span class="token operator">&lt;</span>WinCrossFinal<span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token operator">></span>
<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Test2</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  Equal<span class="token operator">&lt;</span>
    IsPositionOccupied<span class="token operator">&lt;</span>WinCrossFinal<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">,</span> 
    <span class="token boolean">true</span>
  <span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Test3</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  Equal<span class="token operator">&lt;</span>
    IsPositionOccupied<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">,</span> 
    <span class="token boolean">false</span>
  <span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token comment">// @ts-expect-error</span>
<span class="token keyword">type</span> <span class="token class-name">Test4</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  Equal<span class="token operator">&lt;</span>
    IsPositionOccupied<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">,</span> 
    <span class="token boolean">true</span>
  <span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #    GAME That ends in a draw    #</span>
<span class="token comment">// ##################################</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep1</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep2</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep1<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep3</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep2<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep4</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep3<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep5</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep4<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep6</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep5<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep7</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep6<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"32"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawStep8</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep7<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"31"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawFinal</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>DrawStep8<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">DrawOutcome</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  Draw<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">DrawFinal</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token operator">></span><span class="token punctuation">;</span>


<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #     GAME That Cross Wins       #</span>
<span class="token comment">// ##################################</span>
<span class="token keyword">type</span> <span class="token class-name">WinCrossStep1</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCrossStep2</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCrossStep1<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCrossStep3</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCrossStep2<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCrossStep4</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCrossStep3<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCrossFinal</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCrossStep4<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCrossOutcome</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>Equal<span class="token operator">&lt;</span>
   WinCrossFinal<span class="token punctuation">[</span><span class="token string">"winner"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cross
<span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token comment">// ##################################</span>
<span class="token comment">// #              TEST              #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #     GAME That Circle Wins      #</span>
<span class="token comment">// ##################################</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleStep1</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>InitialRound<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleStep2</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCircleStep1<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleStep3</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCircleStep2<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleStep4</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCircleStep3<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleStep5</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCircleStep4<span class="token punctuation">,</span> Cross<span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleFinal</span> <span class="token operator">=</span> Move<span class="token operator">&lt;</span>WinCircleStep5<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> <span class="token string">"31"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">WinCircleOutcome</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>Equal<span class="token operator">&lt;</span>
   WinCircleFinal<span class="token punctuation">[</span><span class="token string">"winner"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Circle
<span class="token operator">>></span><span class="token punctuation">;</span>
</code></pre></div>
</details>
<h1>UI</h1>
<p>I know it’s a bit silly to call this a UI, but hey, it gives you visual indications
of the state of the game and yells at what you are doing wrong if you
try to play the game incorrectly.
So that is a rudimentary UI.
<img src="/adb31bbdbd12e42b529c6e9978e59907/display.gif" alt="">
<img src="/b3b4ec0e74b85401b242ff2f6d2332b5/states_of_game.gif" alt=""></p>
<details>
<summary>UI Display Code that was shown at the beginning of the post</summary>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// To play along</span>
<span class="token comment">// here is a TypeScript playground of the code.</span>
<span class="token comment">// https://tinyurl.com/ts-tic-tac-toe</span>
<span class="token comment">//</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #          Play a Game           #</span>
<span class="token comment">// #              of                #</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// #           Typelevel            #</span>
<span class="token comment">// #          Tic-Tac-Toe           #</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// #              UI                #</span>
<span class="token comment">// #          STARTS HERE           #</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// </span>
<span class="token comment">// This is my attempt of a decent UX (hehe).</span>
<span class="token comment">// 0. Select game board size (3 => 3x3, 4 => 4x4, etc) </span>
<span class="token comment">// 1. Cross will be the first to move</span>
<span class="token comment">// 2. Just enter coordinates as number </span>
<span class="token comment">//    (13 => Coordinate(x=1, y=3))</span>
<span class="token comment">// </span>
<span class="token comment">// The status checks below will turn RED </span>
<span class="token comment">// To show what state the game is in.</span>
<span class="token comment">//</span>
<span class="token comment">// Illegal moves will be compile-time errors</span>
<span class="token comment">// with decent error messages.</span>
<span class="token comment">//</span>
<span class="token comment">// Hover ___DISPLAY__ for a visual representation</span>
<span class="token comment">// of the current state of the game.</span>
<span class="token keyword">type</span> <span class="token class-name">GameSize</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">//   ##############################</span>
<span class="token keyword">type</span> <span class="token class-name">____________DISPLAY___________</span> <span class="token operator">=</span> d
<span class="token comment">//   ##############################</span>

<span class="token keyword">type</span> <span class="token class-name">GameStatus</span> <span class="token operator">=</span>  CrashOrPass<span class="token operator">&lt;</span>SetError<span class="token operator">&lt;</span>
  GameLoop<span class="token operator">&lt;</span><span class="token punctuation">[</span>
  <span class="token comment">//  Ongoing game</span>
  <span class="token comment">// 13,23,33</span>

  <span class="token comment">// Draw </span>
  <span class="token comment">// 13, 23, 33, 12, 22, 11, 32, 31, 21</span>

  <span class="token comment">//  Cross Win</span>
  <span class="token comment">//  11, 32, 22, 12, 33 </span>

  <span class="token comment">//  Circle Win</span>
  <span class="token comment">//  13, 11, 23, 22, 12, 33</span>

  <span class="token comment">//  Play a taken position</span>
  <span class="token comment">//  11, 11</span>

  <span class="token comment">//  Malformed move</span>
  <span class="token comment">//  11, "Hello"</span>

  <span class="token comment">// Illegal move</span>
  <span class="token comment">//  55</span>

  <span class="token comment">//  Play moves after game is won</span>
  <span class="token comment">//  11, 32, 22, 12, 33 13</span>

  <span class="token punctuation">]</span>
<span class="token operator">>>></span>


<span class="token comment">/**********@ts-expect-error*******/</span>
<span class="token comment">//   ##############################</span>
<span class="token keyword">type</span> <span class="token class-name">_______GAME_YET_TO_START______</span> <span class="token operator">=</span> 
        GameYetToStart<span class="token operator">&lt;</span>GameStatus<span class="token operator">></span>
<span class="token comment">//   ##############################</span>

<span class="token comment">/**********@ts-expect-error*******/</span>
<span class="token comment">//   ##############################</span>
<span class="token keyword">type</span> <span class="token class-name">________GAME_IS_ONGOING_______</span> <span class="token operator">=</span> 
        GameIsOngoing<span class="token operator">&lt;</span>GameStatus<span class="token operator">></span>
<span class="token comment">//   ##############################</span>

<span class="token comment">/**********@ts-expect-error*******/</span>
<span class="token comment">//   ##############################</span>
<span class="token keyword">type</span> <span class="token class-name">________GAME_IS_A_DRAW________</span> <span class="token operator">=</span> 
        TheGameIsADraw<span class="token operator">&lt;</span>GameStatus<span class="token operator">></span>
<span class="token comment">//   ##############################</span>

<span class="token comment">/**********@ts-expect-error*******/</span>
<span class="token comment">//   ##############################</span>
<span class="token keyword">type</span> <span class="token class-name">________CROSS_HAS_WON_________</span> <span class="token operator">=</span> 
         CrossHasWon<span class="token operator">&lt;</span>GameStatus<span class="token operator">></span>
<span class="token comment">//   ##############################</span>

<span class="token comment">/**********@ts-expect-error*******/</span>
<span class="token comment">//   ##############################</span>
<span class="token keyword">type</span> <span class="token class-name">_______CIRCLE_HAS_WON_________</span> <span class="token operator">=</span> 
        CircleHasWon<span class="token operator">&lt;</span>GameStatus<span class="token operator">></span>
<span class="token comment">//   ##############################</span>

<span class="token comment">// ##################################</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// #           Typelevel            #</span>
<span class="token comment">// #          Tic-Tac-Toe           #</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// #              UI                #</span>
<span class="token comment">// #           ENDS HERE            #</span>
<span class="token comment">// #--------------------------------#</span>
<span class="token comment">// ##################################</span>
<span class="token comment">// ##################################</span>
</code></pre></div>
</details>
<h3>Ui Code</h3>
<h4>UI Helpers</h4>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// 'd' is just to hide the variable as </span>
<span class="token comment">// much as possible in the UI above</span>
<span class="token keyword">type</span> <span class="token class-name">d</span> <span class="token operator">=</span> ShowBoard<span class="token operator">&lt;</span>GetBoard<span class="token operator">&lt;</span>GameStatus<span class="token operator">>></span>

<span class="token comment">// These are functions give type errors when the game is </span>
<span class="token comment">// not in their state.Then we combine that with </span>
<span class="token comment">// @ts-expect-error to flip that behavior</span>
<span class="token keyword">type</span> <span class="token class-name">TheGameIsADraw<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Draw<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span> <span class="token operator">=</span> <span class="token constant">T</span>
<span class="token keyword">type</span> <span class="token class-name">CrossHasWon   <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Winner<span class="token operator">&lt;</span>Cross<span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span><span class="token operator">=</span> <span class="token constant">T</span>
<span class="token keyword">type</span> <span class="token class-name">CircleHasWon  <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Winner<span class="token operator">&lt;</span>Circle<span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span> <span class="token operator">=</span> <span class="token constant">T</span>
<span class="token keyword">type</span> <span class="token class-name">GameIsOngoing <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> 
                    Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token punctuation">,</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token operator">>>></span></span> <span class="token operator">=</span> <span class="token constant">T</span>
<span class="token keyword">type</span> <span class="token class-name">GameYetToStart<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> InitialRound<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span>
</code></pre></div>
<p>I use <code class="language-text">@ts-expect-error</code> to turn the type errors around. So it shows an error when the types actually type check.
That is useful here, in the absence of something like “extends everything except X”.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">CrossHasWon<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Not<span class="token operator">&lt;</span>Winner<span class="token operator">&lt;</span>Cross<span class="token punctuation">,</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token operator">>>></span></span> <span class="token operator">=</span> <span class="token constant">T</span></code></pre></div>
<h4>Game Loop</h4>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">GameLoop<span class="token operator">&lt;</span><span class="token constant">A</span> <span class="token keyword">extends</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">,</span> 
              <span class="token constant">R</span> <span class="token keyword">extends</span> Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> InitialRound<span class="token punctuation">,</span> 
              <span class="token constant">P</span> <span class="token keyword">extends</span> Player <span class="token operator">=</span> Cross<span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">A</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token keyword">infer</span> Head<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">infer</span> Tail<span class="token punctuation">]</span> <span class="token operator">?</span>
    Head <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">number</span></span> <span class="token operator">?</span>
      Tail <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span></span> <span class="token operator">?</span>
        NumToStr<span class="token operator">&lt;</span>Head<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">Coordinates</span> <span class="token operator">?</span>
          NumToStr<span class="token operator">&lt;</span>Head<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AvailableSquares<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token punctuation">[</span><span class="token string">"board"</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">?</span>
            Move<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token punctuation">,</span><span class="token constant">P</span><span class="token punctuation">,</span>NumToStr<span class="token operator">&lt;</span>Head<span class="token operator">></span> <span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">Round<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token punctuation">,</span><span class="token builtin">any</span><span class="token operator">></span></span> <span class="token operator">?</span>
              GameLoop<span class="token operator">&lt;</span>Tail<span class="token punctuation">,</span> Move<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token punctuation">,</span><span class="token constant">P</span><span class="token punctuation">,</span>NumToStr<span class="token operator">&lt;</span>Head<span class="token operator">></span> <span class="token operator">></span><span class="token punctuation">,</span> GetNextPlayer<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">>></span> <span class="token operator">:</span> 
              Tail <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">?</span> 
                Move<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token punctuation">,</span><span class="token constant">P</span><span class="token punctuation">,</span>NumToStr<span class="token operator">&lt;</span>Head<span class="token operator">></span> <span class="token operator">></span> 
                <span class="token operator">:</span> <span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">No more moves allowed, game is over</span><span class="token template-punctuation string">`</span></span><span class="token operator">></span>
          <span class="token operator">:</span> <span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Square '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Head<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' already taken</span><span class="token template-punctuation string">`</span></span><span class="token operator">></span>
        <span class="token operator">:</span> <span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Coordinate '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Head<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' is illegal</span><span class="token template-punctuation string">`</span></span><span class="token operator">></span> 
      <span class="token operator">:</span> <span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Tail of Coordinate array is malformatted</span><span class="token template-punctuation string">`</span></span><span class="token operator">></span>
    <span class="token operator">:</span> <span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Coordinate '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Head <span class="token keyword">extends</span> <span class="token class-name">ToStringableTypes</span> <span class="token operator">?</span> Head <span class="token operator">:</span> <span class="token builtin">never</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' is not a number</span><span class="token template-punctuation string">`</span></span><span class="token operator">></span>
  <span class="token operator">:</span> <span class="token constant">R</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">__ERROR__: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">type</span> <span class="token class-name">SetError<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token string">"error"</span> <span class="token operator">:</span> <span class="token string">"noError"</span><span class="token punctuation">]</span>
<span class="token keyword">type</span> <span class="token class-name">CrashOrPass<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">unknown</span><span class="token punctuation">,</span> <span class="token string">"noError"</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">NumToStr<span class="token operator">&lt;</span><span class="token constant">N</span> <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">N</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></code></pre></div>
<p>First of we create some data abstraction in that we allow the players to enter <code class="language-text">number</code> instead
of <code class="language-text">Coordinate</code> then we do some conditional checks to see if that number can be cast into a
<code class="language-text">Coordinate</code> this makes the UI easier to use since we don’t have to add <code class="language-text">""</code> around all moves.</p>
<p>We are kind of able to simulate <code class="language-text">X extends not&lt;...></code> (i.e type-error if X does extend) a bit with <code class="language-text">SetError</code> and <code class="language-text">CrashOrPass</code> which needs to be used together, I don’t know how to put them together into one typelevel function or even better get <code class="language-text">GameLoop</code> to have this constraint by itself. With more work, it’s probably possible.</p>
<p><code class="language-text">GameLoop</code> is a recursive typelevel function that ends when the game ends or an error occurs.
The errors give informative information like <code class="language-text">__ERROR__: Square '${Head}' already taken</code>
I think it’s really cool that we can just inject <code class="language-text">Head</code> into a string and get type errors like
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0979961bdbc29276a0ade8d3637e8350/e40ed/custom-errors.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 32.278481012658226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAABXXAAAV1wEELLsZAAAA6UlEQVQY00WPWY7DIBBEc5DY0BgwmN4wMU4y0cz9bzVyFuWpVFJ9vJb6FBew3roALoILYCfr02SsGYZhHMfzMJzPr3wZPpwS+Zkkr2tWnlPI2XsPMTofYJpsjC5GCAHClxhCMMaM43iai9t6fzx++359/Nzu9+1665emRJm5tCa1kgiKqmhd1yaixOyce8uq2vtOSMxaConUWhuRqK6qK7MiMrPkvJSCc8rznN5yQr/Ipv2vtu1ysO37tbUL4nEMkRCplIJI6amllHNevPfHz5kCFmaqZcHJTy8AwFqwH57zaAD37GMaY/4Bnos4bP/jXIAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="custom errors"
        title="custom errors"
        src="/static/0979961bdbc29276a0ade8d3637e8350/f058b/custom-errors.png"
        srcset="/static/0979961bdbc29276a0ade8d3637e8350/c26ae/custom-errors.png 158w,
/static/0979961bdbc29276a0ade8d3637e8350/6bdcf/custom-errors.png 315w,
/static/0979961bdbc29276a0ade8d3637e8350/f058b/custom-errors.png 630w,
/static/0979961bdbc29276a0ade8d3637e8350/40601/custom-errors.png 945w,
/static/0979961bdbc29276a0ade8d3637e8350/78612/custom-errors.png 1260w,
/static/0979961bdbc29276a0ade8d3637e8350/e40ed/custom-errors.png 1378w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>To not just get a return type of a custom error but actually get a compile-time error highlighting it we wrap <code class="language-text">GameLoop</code> in
<code class="language-text">SetError</code> and <code class="language-text">CrashOrPass</code>.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">SetError<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">,</span> 
                    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">?</span> 
                        <span class="token string-property property">"error"</span> 
                      <span class="token operator">:</span> <span class="token string">"noError"</span>
                   <span class="token punctuation">]</span></code></pre></div>
<p>If the return type that extends <code class="language-text">GAME_ERROR&lt;string></code> then set the second value in the tuple to <code class="language-text">"error"</code>.</p>
<p><code class="language-text">CrashOrPass</code> then takes the return type from <code class="language-text">SetError</code> and if the second value is <strong>not</strong> <code class="language-text">"noError"</code>
we get a compile time error, which is exactly what we want.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">CrashOrPass<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">unknown</span><span class="token punctuation">,</span> <span class="token string">"noError"</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>
<p>If we do not get a compile-time error the first value of the tuple is returned
which is just non-error type.</p>
<p><em>(In TypeScript types propagate if possible even if there is a type-error, like here <code class="language-text">T[0]</code> is not the part with the type-error so that propagates.  We use this to also show the error in <code class="language-text">___DISPLAY___</code>)</em></p>
<p>I know it’s common in Erlang and <a href="https://elixirschool.com/en/lessons/intermediate/error_handling">Elixir</a> to follow this type of pattern on the value level.
by returning <code class="language-text">{:ok, data } | {:error, reason}</code>.</p>
<h3>Display</h3>
<p>Best for last, the display is the coolest feature!
We want to produce a UI like</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>To show the state of the game when hovering the type</p>
<p>We use the Board, to first change the Squares from
<code class="language-text">Circle | Cross | Empty</code> to <code class="language-text">X | O | _</code></p>
<p>Then it’s a matter of producing a layout that the type-checker
will display in a nice way. String was no good because multiline
strings become <code class="language-text">XXO\nX_O\n__O</code>.
Multidimensional arrays are also just one line
<code class="language-text">[[X,X,O],[X,_,O],[_,_,O]</code>]` So settled for an object where the keys are the rows.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span>
  <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Show the state of the game when hovering the type instantiated type</span>
<span class="token keyword">type</span> <span class="token class-name">PrintGameDisplay<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>GameStates <span class="token operator">|</span> <span class="token constant">GAME_ERROR</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">GameStates</span> <span class="token operator">?</span> ShowBoard<span class="token operator">&lt;</span>GetBoard<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span> <span class="token operator">:</span> <span class="token constant">T</span>

<span class="token comment">// Some shorter and nicer looking symbols for the Display</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">X</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">O</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">_</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// UIBoard</span>
<span class="token comment">// Coordinates to something that we want to Display</span>
<span class="token keyword">type</span> <span class="token class-name">UIBoard</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>s <span class="token keyword">in</span> Coordinates<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">}</span>

<span class="token comment">/// #### DISPLAY HELPERS ####</span>

<span class="token keyword">type</span> <span class="token class-name">ShowBoard<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token operator">></span></span> <span class="token operator">=</span> ShowUIBoard<span class="token operator">&lt;</span>ToUIBoard<span class="token operator">&lt;</span><span class="token constant">B</span><span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token comment">// ToUIBoard</span>
<span class="token comment">// The particular board we want to show</span>
<span class="token comment">// Structurally, a UIBoard</span>
<span class="token keyword">type</span> <span class="token class-name">ToUIBoard<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> Board<span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token punctuation">{</span><span class="token punctuation">[</span>s <span class="token keyword">in</span> Coordinates<span class="token punctuation">]</span><span class="token operator">:</span> ChangeSquare<span class="token operator">&lt;</span><span class="token constant">B</span><span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ChangeSquare<span class="token operator">&lt;</span><span class="token constant">S</span> <span class="token keyword">extends</span> Square<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">S</span> <span class="token keyword">extends</span> <span class="token class-name">Cross</span>  <span class="token operator">?</span> <span class="token constant">X</span>
                                    <span class="token operator">:</span> <span class="token constant">S</span> <span class="token keyword">extends</span> <span class="token class-name">Circle</span> <span class="token operator">?</span> <span class="token constant">O</span>
                                    <span class="token operator">:</span> <span class="token constant">S</span> <span class="token keyword">extends</span> <span class="token class-name">Empty</span>  <span class="token operator">?</span> _
                                    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// We want our coordinate system to have 1,1 bottom left</span>
<span class="token comment">// and Size,Size top right</span>
<span class="token keyword">type</span> <span class="token class-name">RowsBackwards</span>  <span class="token operator">=</span> FromToDec<span class="token operator">&lt;</span>Size<span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">></span>
<span class="token keyword">type</span> <span class="token class-name">ColumnsForward</span> <span class="token operator">=</span> FromToInc<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span>Size<span class="token operator">></span>

<span class="token comment">// ShowUIBoard</span>
<span class="token keyword">type</span> <span class="token class-name">ShowUIBoard<span class="token operator">&lt;</span><span class="token constant">B</span> <span class="token keyword">extends</span> UIBoard <span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token punctuation">{</span><span class="token punctuation">[</span>key <span class="token keyword">in</span> <span class="token keyword">keyof</span> RowsBackwards <span class="token keyword">as</span> KeyToValue<span class="token operator">&lt;</span>RowsBackwards<span class="token punctuation">,</span>key<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> RowsBackwards<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">number</span></span> 
    <span class="token operator">?</span> TupleCoordinateLookups<span class="token operator">&lt;</span>Zip<span class="token operator">&lt;</span>ColumnsForward<span class="token punctuation">,</span>Repeat<span class="token operator">&lt;</span>RowsBackwards<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> Size<span class="token operator">>></span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">}</span> 

  <span class="token keyword">type</span> <span class="token class-name">KeyToValue<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
      <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">number</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">?</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

  <span class="token keyword">type</span> <span class="token class-name">Repeat<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">N</span> <span class="token keyword">extends</span> <span class="token builtin">number</span><span class="token punctuation">,</span> arr <span class="token keyword">extends</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> 
      <span class="token constant">N</span> <span class="token keyword">extends</span> <span class="token number">0</span> <span class="token operator">?</span> arr <span class="token operator">:</span> Repeat<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> MinusOne<span class="token operator">&lt;</span><span class="token constant">N</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token operator">...</span>arr<span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token keyword">type</span> <span class="token class-name">TupleCoordinateLookups<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">B</span> <span class="token keyword">extends</span> UIBoard<span class="token operator">></span></span> <span class="token operator">=</span> 
    <span class="token punctuation">{</span><span class="token punctuation">[</span>Key <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> TupleCoordinateLookup<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">type</span> <span class="token class-name">TupleCoordinateLookup<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">B</span> <span class="token keyword">extends</span> UIBoard<span class="token operator">></span></span> <span class="token operator">=</span> 
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">B</span> <span class="token operator">?</span> <span class="token constant">B</span><span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token comment">// ShowUIBoard End</span></code></pre></div>
<p>I indented the types that are just helpers for <code class="language-text">ShowUIBoard</code>.
We only have some limited ability to create named type variables in a scope
which I have already shown, <code class="language-text">&lt;..., MyType = MyTypeFunc&lt;T>></code>
So here is another approach based only on convention and there to make the code
easier to browse. When you have access to creating multiple files you can ofc
create your scope that way.</p>
<p><code class="language-text">ToUiBoard</code> loops through all <code class="language-text">Coordinates</code> and maps the members of the <code class="language-text">Square</code> type to another type that we would like to display.</p>
<p><code class="language-text">ShowUIBoard</code> uses one trick we have not seen yet.
<a href="https://www.typescriptlang.org/docs/handbook/2/mapped-types.html#key-remapping-via-as">https://www.typescriptlang.org/docs/handbook/2/mapped-types.html#key-remapping-via-as</a>
it’s the <code class="language-text">as</code> syntax that lets us change the <code class="language-text">key</code> while we are mapping.
That is perfect here because we use the keys <code class="language-text">0,1,2, ...Size</code> in <code class="language-text">RowsBackwards</code>
to be mapped to the value at each index, so we get the rows of our display object.</p>
<p>ex. <code class="language-text">RowArray[0]</code> value is <code class="language-text">Size</code>
<code class="language-text">RowArray[0]</code> value is <code class="language-text">Size-1</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Size<span class="token punctuation">]</span>    <span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Size <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Then for the values on each <code class="language-text">row</code> we combine the column values together
with the current row value, by using the Zip operation, where
the second argument is just the <code class="language-text">row</code> repeated column length times.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token function">Zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div>
<p>Then we do a lookup for each tuple <code class="language-text">[x,y]</code> to get the
corresponding symbol representing the state.
We do that by first turning <code class="language-text">[x,y]</code> into a string <code class="language-text">${x}{y}</code>
and the end result is an object that looks like this.</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span>
  <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token constant">O</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>And this is our display!
Now we have everything we need to produce the final product.
<img src="/adb31bbdbd12e42b529c6e9978e59907/display.gif" alt=""></p>
<h3>Closing thoughts</h3>
<p>Thanks for reading this far! I hope you learned something on this journey.  TypeScript is very powerful and you can basically do anything you want as long as you are willing to spend enough time.
It just gets more and more awkward to achieve the constraints on the typelevel.
I would not say that this is any good practice in general, but knowing that something is possible could
make it worth exploring in cases where it would be worth the end result.</p>
<p>A few years ago I was of the opinion that if you could have static guarantees you should.
Now I still want those guarantees but I think it’s very prudent and acceptable to use something like
type guards</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isDog</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//do something</span>
<span class="token punctuation">}</span></code></pre></div>
<p>And write code that is still safe but does runtime checks,
usually this lead to simpler solutions.</p>
<p>Don’t forget to check out the next cohort of our course in Advanced Software Design.
<a href="https://jameskoppelcoaching.com/advanced-software-design-web-course/">https://jameskoppelcoaching.com/advanced-software-design-web-course/</a></p>
<p>Cheers!</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#281838;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/79977020e69335e5a24f2d04c9860414/d4bf4/profile-pic.avif 50w,/static/79977020e69335e5a24f2d04c9860414/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/79977020e69335e5a24f2d04c9860414/3faea/profile-pic.webp 50w,/static/79977020e69335e5a24f2d04c9860414/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/79977020e69335e5a24f2d04c9860414/d24ee/profile-pic.jpg" data-srcset="/static/79977020e69335e5a24f2d04c9860414/d24ee/profile-pic.jpg 50w,/static/79977020e69335e5a24f2d04c9860414/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/79977020e69335e5a24f2d04c9860414/d4bf4/profile-pic.avif 50w,/static/79977020e69335e5a24f2d04c9860414/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/79977020e69335e5a24f2d04c9860414/3faea/profile-pic.webp 50w,/static/79977020e69335e5a24f2d04c9860414/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/79977020e69335e5a24f2d04c9860414/d24ee/profile-pic.jpg" srcSet="/static/79977020e69335e5a24f2d04c9860414/d24ee/profile-pic.jpg 50w,/static/79977020e69335e5a24f2d04c9860414/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><p class="text-md font-sans">My name is <!-- --><strong>Nils Eriksson</strong>. I&#x27;m a software educator at<!-- --> <!-- --><a href="https://mirdin.com/">Mirdin | The Code Quality Company</a>. I enjoy thinking deeply about software, this blog is a collection of my thoughts.<!-- --></p></div><iframe src="https://note89.github.io//next-course-iframe/?mode=base" width="100%" frameborder="0" scrolling="no" class="h-80 sm:h-56"></iframe></footer></article><nav class="blog-post-nav bg-yellow-500 p-4 border border-solid border-yellow-400 border-4"><ul class="bold" style="display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;list-style:none;padding:0;gap:1rem"><li class="m-0"><a rel="prev" href="/state-of-emergency/">← <!-- -->State of emergency! The four ways your state might be wrong<!-- --></a></li><li class="m-0"></li></ul></nav></main><footer>© <!-- -->2022<!-- -->, Built with<!-- --> <!-- --><a href="https://www.gatsbyjs.com">Gatsby</a></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/typelevel-tic-tac-toe-in-typescript/";window.___webpackCompilationHash="60dadbe503358832f689";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-67664a8ccc6c9f02b880.js"],"app":["/app-6e5d78ed429d9b591b76.js"],"component---src-pages-404-js":["/component---src-pages-404-js-27981ca7dd461cb4280e.js"],"component---src-pages-iframes-tsx":["/component---src-pages-iframes-tsx-66b9eb6a13ce49ec3863.js"],"component---src-pages-index-js":["/component---src-pages-index-js-d85a52553c828442248a.js"],"component---src-pages-next-course-iframe-tsx":["/component---src-pages-next-course-iframe-tsx-691c79567358a6ec2cdf.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-016a77410a056c7e5425.js"]};/*]]>*/</script><script src="/polyfill-67664a8ccc6c9f02b880.js" nomodule=""></script><script src="/app-6e5d78ed429d9b591b76.js" async=""></script><script src="/framework-a90df563a3fe4f48300d.js" async=""></script><script src="/webpack-runtime-06ed631280f5fdc770b8.js" async=""></script></body></html>